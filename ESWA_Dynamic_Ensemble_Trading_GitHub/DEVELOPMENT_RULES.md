# 🚀 ESWA 동적 앙상블 강화학습 거래 시스템 개발 룰

## 📋 **프로젝트 개요**
- **목표**: 시장 체제 변화에 동적으로 적응하는 강화학습 거래 시스템 구축
- **핵심**: 계층적 앙상블 프레임워크 + Confidence-based Selection 메커니즘
- **기술**: 멀티모달 학습 + PPO + XGBoost + 동적 앙상블

## 🎯 **핵심 기술 요소**

### 1. 멀티모달 특징 추출
- **시각적 특징**: ResNet-18 기반 캔들스틱 차트 분석 (256차원)
- **기술적 특징**: 15개 핵심 기술지표 (SMA, EMA, RSI, MACD, Bollinger Bands 등)
- **감정 특징**: LLM 기반 뉴스 감정분석 (2차원)
- **최종 상태벡터**: 273차원 (256+15+2)

### 2. 시장 체제 분류 모듈
- **XGBoost 기반 확률적 체제 분류**
- **3개 체제**: Bull Market, Bear Market, Sideways Market
- **Confidence-based Selection**: θ=0.6 임계값
- **체제 전환 불확실성 관리**

### 3. 체제별 전문 에이전트 풀
- **각 체제별 5개 PPO 에이전트** (다양성 확보)
- **체제별 맞춤형 보상함수**:
  - Bull: 수익극대화 (단순 포트폴리오 수익)
  - Bear: 손실최소화 (Sortino Ratio 기반)
  - Sideways: 거래비용 최소화 (거래 억제)

### 4. 동적 앙상블 의사결정
- **30일 성과 기반 동적 가중치 할당**
- **Softmax 함수**: T=10 (최적 엔트로피 균형)
- **성과 기반 가중 평균 앙상블**

## 🏗️ **프로젝트 구조**
```
ESWA_Dynamic_Ensemble_Trading/
├── src/
│   ├── multimodal/           # 멀티모달 특징 추출
│   ├── regime/               # 시장 체제 분류
│   ├── agents/               # PPO 에이전트 풀
│   ├── ensemble/             # 동적 앙상블 시스템
│   ├── trading/              # 거래 환경 및 백테스팅
│   └── utils/                # 유틸리티 함수
├── configs/                  # 설정 파일
├── data/                     # 데이터 저장소
├── models/                   # 훈련된 모델
├── results/                  # 결과 및 성과
├── tests/                    # 단위 테스트
└── docs/                     # 문서
```

## 📅 **개발 단계 계획**

### **Phase 1: 프로젝트 구조 및 환경 설정 (1-2일)**
- [x] 프로젝트 폴더 생성 및 구조 설정
- [x] 의존성 패키지 설치 및 환경 구성
- [x] 기본 설정 파일 및 로깅 시스템 구축
- [x] __init__.py 파일 생성

### **Phase 2: 핵심 모듈 구현 (3-5일)**
- [ ] **멀티모달 특징 추출 모듈**
  - [ ] 캔들스틱 차트 이미지 생성 및 ResNet-18 처리
  - [ ] 기술적 지표 계산 및 정규화
  - [ ] 뉴스 감정분석 및 특징 벡터 생성
- [ ] **시장 체제 분류 모듈**
  - [ ] XGBoost 기반 체제 분류기 구현
  - [ ] Confidence-based Selection 메커니즘
  - [ ] 체제 전환 불확실성 관리
- [ ] **체제별 전문 에이전트 풀**
  - [ ] PPO 에이전트 구현 (5개 에이전트)
  - [ ] 체제별 맞춤형 보상함수 설계
  - [ ] 에이전트 훈련 및 최적화

### **Phase 3: 앙상블 시스템 및 거래 환경 (2-3일)**
- [ ] **동적 앙상블 의사결정 모듈**
  - [ ] 성과 기반 동적 가중치 할당
  - [ ] Softmax 함수를 통한 가중치 정규화
  - [ ] 최종 정책 결정 및 액션 생성
- [ ] **거래 환경 및 백테스팅**
  - [ ] Binance API 연동 및 실시간 데이터 수집
  - [ ] 거래 비용 및 슬리피지 모델링
  - [ ] 포트폴리오 관리 및 성과 추적

### **Phase 4: 통합 및 최적화 (2-3일)**
- [ ] **시스템 통합 및 테스트**
  - [ ] 전체 파이프라인 통합
  - [ ] 단위 테스트 및 통합 테스트
  - [ ] 성능 최적화 및 하이퍼파라미터 튜닝
- [ ] **문서화 및 배포**
  - [ ] README 및 API 문서 작성
  - [ ] 사용 예제 및 튜토리얼 제작
  - [ ] 성과 분석 및 시각화 도구

## 🎯 **성과 목표 지표**
- **Sharpe Ratio**: 1.35 → 1.89 (40% 향상)
- **Maximum Drawdown**: 24.8% → 16.2% (8.6%p 감소)
- **2022년 베어마켓**: -12.3% → +7.9% (20.2%p 차이)
- **6개월 실시간 검증**: Buy & Hold 대비 12.5%p 초과수익

## 🔧 **핵심 하이퍼파라미터**
- **체제 분류 임계값 (θ)**: 0.6
- **성과 평가 기간**: 30일
- **앙상블 온도 (T)**: 10
- **PPO 학습률**: 3e-4
- **배치 크기**: 256
- **할인 인자 (γ)**: 0.99

## 📝 **개발 규칙**
1. **단계별 구현**: 각 Phase를 순차적으로 완료
2. **테스트 우선**: 각 모듈 구현 후 단위 테스트 작성
3. **문서화**: 코드와 함께 상세한 주석 및 문서 작성
4. **성능 검증**: 각 단계별 성과 지표 확인
5. **코드 품질**: PEP 8 스타일 가이드 준수

## 🚨 **주의사항**
- 시장 체제 전환 시 정책 안정성 확보
- 불확실성 상황에서의 보수적 접근
- 과적합 방지를 위한 교차 검증
- 실시간 거래 환경에서의 안정성

---
**마지막 업데이트**: 2025-09-04
**현재 진행률**: Phase 1 - 프로젝트 구조 및 환경 설정 완료 (100%)
**다음 단계**: Phase 2 - 멀티모달 특징 추출 모듈 구현

## 🎉 **Phase 1 완료 요약**
- ✅ 프로젝트 폴더 생성 및 구조 설정
- ✅ 의존성 패키지 설치 및 환경 구성 (requirements.txt)
- ✅ 기본 설정 파일 및 로깅 시스템 구축 (config.yaml)
- ✅ __init__.py 파일 생성 (모든 패키지)
- ✅ README.md 및 개발 룰 문서 작성
